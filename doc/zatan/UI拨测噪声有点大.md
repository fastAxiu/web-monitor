最近完善了一下前端重要页面的UI用例，对接到部门的拨测平台（定期执行用例，比如说30mins一次）上。整体感受是，噪音比较大。每次出现用例失败的情况，就会提事件单，提单就要走SRE，SRE再来跟我确认，大多数情况是误报，两边都麻烦。所以要花费不小的心神去沟通和优化用例。

昨天，我就去跟拨测的人聊，噪音比较大的情况下，可不可以提高一下事件单的门槛，多几个用例报错的时候再提单。拨测的同事显然早已经意识到这个问题，调整速度非常快，当天就给改成了全部用例失败才提单。当然个别用例失败也会在IM工具群里告警，但是那样的话我只要快速去页面确认一下就好，成本较低。

拨测用例失败的原因主要分布在几个方面：
1、用例或者拨测不稳定，莫名其妙地失败（偶现情况）
2、业务数据波动导致用例失败，比如要点击的元素找不到（常见情况）
3、前端页面的变化导致用例失败，比如dom结构的变化（常见情况）

业务数据波动的问题，就要求我们在录制用例时需要考虑到这个情况。比如说，如果我们录制的用例是查询表格数据，然后点击一条进入详情。那就要考虑到凌晨执行这个用例的时候，是否能查询到列表数据。

dom结构变化导致用例失败，源头就在于大多数UI用例使用xpath来定位交互元素，而xpath又是一个非常容易发生变化的东西。刚好今早看到早早聊里面有一期讲UI测试用例的分享。里面就提到说，他们团队使用约定来解决xpath易变的问题，具体操作方式就是将页面上的元素分为交互元素和展示元素两种，对于交互元素来说，给他们设置id和desc，用id标记元素更稳定，desc可以给团队其他成员传递足够的信息，不失为一个好的实践。

![boce](../img/boce.png)